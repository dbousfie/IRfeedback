<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Evaluation summary</title>
  <link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel="stylesheet" />
  <style>
    body {
      font-family: 'Lato', sans-serif;
      margin: 2rem;
    }
    .input-group {
      display: flex;
      gap: 2rem;
      align-items: flex-start;
      margin-bottom: 2rem;
    }
    .input-box, .sample-box {
      flex: 1;
      max-width: 600px;
    }
    textarea {
      font-family: monospace;
      width: 100%;
    }
    .sample-content {
      background: #f9f9f9;
      border: 1px solid #ccc;
      padding: 0.5rem;
      font-family: monospace;
      white-space: pre-wrap;
    }
    #response {
      white-space: pre-wrap;
      margin-top: 1rem;
      padding: 1rem;
      background: #f4f4f4;
      border: 1px solid #ccc;
      max-width: 600px;
    }
  </style>
</head>
<body>
  <h2> feedback mechanism</h2>

<form id="queryForm">
  <div class="input-group">
    <div class="input-box">
      <label for="instructor">Reviewer Essay Comments:</label><br />
      <textarea name="instructor" id="instructor" rows="4" cols="60" placeholder="Enter your comments here..."></textarea>
    </div>
    <div class="sample-box">
      <label>Sample Feedback:</label>
      <div class="sample-content">
       Excellent writing, strong clear engagement with the course readings. Very well argued paper with lots of examples and a close reading of the text synthesized with textbook. Excellent work
      </div>
    </div>
  </div>

  <div class="input-group">
    <div class="input-box">
      <label for="essay">Essay for submission:</label><br />
      <textarea name="essay" id="essay" rows="10" cols="60" placeholder="Paste the student essay here..."></textarea>
    </div>
    <div class="sample-box">
      <label>Sample Essay:</label>
      <div class="sample-content">
        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Proin quis lorem non urna congue.
      </div>
    </div>
  </div>

  <button type="submit">Submit - all submissions and responses are stored with qualtrics - NEVER include any personal identifiers</button>
</form>

<h3>Response:</h3>
<pre id="response"></pre>

<script>
  const form = document.getElementById("queryForm");
  const responseBox = document.getElementById("response");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();
    responseBox.textContent = "Loading...";

    const instructor = document.getElementById("instructor").value;
    const essay = document.getElementById("essay").value;

    const combinedQuery = `
db2025
The instructor’s in-text comments are authoritative and must guide all feedback. Do not override, soften, or generalize them.

# Instructor Comments:
${instructor}

# Student Essay:
${essay}

Please provide structured feedback under the six db2025 categories. Feedback must be concise, evaluative, and written in the instructor’s voice.
    `.trim();

    try {
      const res = await fetch("https://irfeedback0609.deno.dev/", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ query: combinedQuery }),
      });

      const text = await res.text();
      responseBox.textContent = text;
    } catch (err) {
      responseBox.textContent = "Error contacting server.";
    }
  });
</script>

</body>
</html>
